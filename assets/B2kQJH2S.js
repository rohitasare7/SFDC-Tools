import{_ as Ue,a as Le}from"./CuTdjjvY.js";import{u as Me,r as Fe,R as Ge,S as ze,T as He,_ as Je,a as We,b as Ye,D as Xe}from"./tyoosHN1.js";import{_ as Ze}from"./CKP9D31c.js";import{_ as Ke}from"./D7mtGAGI.js";import{_ as Qe}from"./C0MpYsF0.js";import{_ as ea}from"./PYXEAhwZ.js";import{_ as aa}from"./BCUAfS-d.js";import{f as ta,z as sa,U as oa,r,B as la,i as ra,n as na,o as i,c as v,b as s,d as l,w as k,e as A,t as _,u as t,q as T,x as j,s as c,C as P,T as $,S as z,y as ca,k as ia,V as da,F as ua,j as H}from"./Ho11KFCP.js";import{_ as ma}from"./FIoW0_7y.js";import{c as N,i as fa,a as ha,b as ya}from"./ycDIoMx1.js";import{_ as ve}from"./C1WC2wNv.js";import{_ as be}from"./BA2uKlca.js";import{T as J,o as xa,E as ga}from"./BQImT8Uo.js";import{j as va}from"./C4sX3Osg.js";import{u as ba}from"./bkTsuWyN.js";import{a as b,c as pa,e as _a}from"./COAcYwch.js";import{u as wa}from"./Z-iyx2tQ.js";import{r as ka}from"./DLsSqBkb.js";const Da={class:"flex justify-between"},Sa={class:"flex flex-col"},Ca={class:"flex items-center justify-between my-4"},Aa={key:0,class:"flex items-center"},Ta={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},Ra={class:"icon"},Va={class:"flex items-center justify-end"},Ba={key:1,class:"flex items-center justify-center"},Ea={key:0,class:"my-4"},Pa={class:"relative overflow-x-auto shadow-md dark:shadow-xl sm:rounded-lg border dark:border-gray-600"},$a={class:"w-full text-gray-800 dark:text-gray-400 text-sm table-auto"},Oa={class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700"},Ia={class:"w-1/2 sm:w-auto px-2 py-3 text-center"},ja={class:"px-6 py-4 text-center"},Na={class:"w-1/2 sm:w-auto px-2 py-3 text-left whitespace-pre-line"},qa={class:"dark:border-gray-700 dark:shadow-xl dark:border rounded-lg overflow-hidden"},Ua={class:"flex justify-between items-center"},La={class:"flex justify-between place-items-end"},Ma={class:"relative inline-flex mr-2"},Fa={class:"flex absolute h-2 w-2 top-0 right-0 -mt-1 -mr-2"},Ga={class:"dark:border-gray-700 dark:shadow-xl dark:border rounded-lg overflow-hidden mb-2"},za={class:"dark:border-gray-700 dark:shadow-xl dark:border rounded-lg overflow-hidden"},Ha={class:"p-6"},Ja={key:0,class:"mt-1 text-sm text-gray-600 dark:text-gray-400"},Wa={class:"mt-6"},Ya={key:0,class:"mt-1 text-sm text-gray-600 dark:text-gray-400"},Xa={key:1,class:"flex items-center justify-center"},yt=ta({__name:"index",props:{searchData:Object},setup(pe){var ae,te,se,oe,le,re;ba({title:"Execute Anonymous Apex | SFDC Developer Toolkit",ogTitle:"Execute Anonymous Apex | SFDC Developer Toolkit",description:"Execute ananoymous salesforce apex code, save and share with your team.",ogDescription:"Execute ananoymous salesforce apex code, save and share with your team."});const a=pe,q=[va(),xa,ga.lineWrapping],_e=sa(),U=o=>{_e.value=o.view},W=oa(),Y=Me(),R=r(!1),y=r(""),L=r(!0),D=r(null),S=r(!1),M=r(!1),X=r("Debug Log Response"),F=r("Debug Only"),w=r((ae=a==null?void 0:a.searchData)!=null&&ae.apexCode?(te=a==null?void 0:a.searchData)==null?void 0:te.apexCode:"system.debug('test --> '+system.now());"),G=r(null),we=async()=>{var u,g;if(!G.value){b("Please authorize an org first.","Error");return}S.value=!0,p.value=!1;const o=((u=G.value)==null?void 0:u.instance_url)??"",e=await $fetch("/api/sfdc/soap/executeApex",{query:{},method:"POST",body:{apexCode:w.value}});if(!e.success&&e.error){((g=e.response)==null?void 0:g.data)=="sf:INVALID_SESSION_ID"?(b("Please re-authenticate your org : "+o,"Error"),H("/settings/orgs")):b("Unknown error occured, something is wrong.","Error");return}if(y.value=e.response.data,L.value=e.response.isSucccess,!L.value)if(e.response.errorData.compiled!="false")D.value=e.response.errorData;else if(e.response.errorData.compiled=="false")D.value={exceptionMessage:e.response.errorData.compileProblem,exceptionStackTrace:`column : ${e.response.errorData.column}, line : ${e.response.errorData.line}`};else{S.value=!1;return}S.value=!1},ke=async o=>{G.value=o},De=()=>{w.value="",y.value="",H("/tools/executeApex/")},n=r(!0),Z=r("auto"),K=()=>{n.value=!n.value,Z.value=n.value?"auto":"600px"},V=r(""),p=r(!1),Se=()=>{p.value=!p.value,V.value=pa(y.value),F.value="Debug Only"},Ce=async()=>{var g;M.value=!0;const e={prompt:`you are a senior salesforce developer, please check this apex debug log for any errors(FATAL_ERROR,EXCEPTION_THROWN or any Apex Error), issues and suggest fixes, if there are no errors then just explain it. the apex debug log data :

 ${y.value?y.value:""}`,isImagePrompt:!1,imgPromptUrl:""},{data:u}=await wa("/api/googleGemini",{method:"POST",body:{params:e},server:!0},"$B8JBtusSfh");V.value=(g=u.value)==null?void 0:g.candidates[0].content.parts[0].text,p.value=!0,M.value=!1,F.value="Google Gemini Analysis"},x=r({name:(se=a==null?void 0:a.searchData)!=null&&se.name?(oe=a==null?void 0:a.searchData)==null?void 0:oe.name:"",shared:(le=a==null?void 0:a.searchData)!=null&&le.shared?(re=a==null?void 0:a.searchData)==null?void 0:re.shared:!1,user:null}),Q=r(null),f=r(null),O=r("Save to Cloud"),d=r("Save"),I=r(null),h=r(!1),Ae=o=>{o()},C=()=>{R.value=!1},Te=()=>{_a(Y,!0)},Re=async()=>{var o;f.value||(f.value=await N()),Q.value={table:"tool_executeApex",fields:"id,name",like:{searchColumn:"name"},orStatement:`user.eq.${(o=f.value)==null?void 0:o.id},shared.eq.true`}},Ve=async()=>{var o,e;(o=a==null?void 0:a.searchData)!=null&&o.id&&((e=a==null?void 0:a.searchData)==null?void 0:e.createdBy)==f.value.name?await $e():await ee()},ee=async()=>{I.value=Be,O.value="Save to Cloud",d.value="Save",R.value=!0},Be=async()=>{h.value=!0,f.value||(f.value=await N());const o={table:"tool_executeApex",insertValues:[{name:x.value.name,user:f.value.id,apexCode:w.value,shared:x.value.shared}],selectValues:"id, name"},e=await fa(o);if((e==null?void 0:e.code)=="23505"&&(e!=null&&e.message)){b("Duplicate record exists, please choose different name.","Error"),h.value=!1;return}else e!=null&&e.id?(b("Record has been saved","Success"),W.push(`/tools/executeApex/${e==null?void 0:e.id}`)):(console.log("error --> "+JSON.stringify(e)),b("Record was not inserted, check dev console for errors","Error"));h.value=!1,C()},Ee=async()=>{var o;I.value=Pe,O.value="Delete Record : "+((o=a==null?void 0:a.searchData)==null?void 0:o.name),d.value="Delete",R.value=!0},Pe=async()=>{var u,g;if(!((u=a==null?void 0:a.searchData)!=null&&u.id))return;h.value=!0;const o={table:"tool_executeApex",filter:{compareTo:"id",CompareValue:(g=a==null?void 0:a.searchData)==null?void 0:g.id}},e=await ha(o);console.log("deleteRecord --> "+JSON.stringify(e)),h.value=!1,C(),b("Record has been deleted."),await H("/tools/executeApex/")},$e=async()=>{var o;I.value=Oe,O.value="Update your record : "+((o=a==null?void 0:a.searchData)==null?void 0:o.name),d.value="Update",R.value=!0},Oe=async()=>{var u;h.value=!0,f.value||(f.value=await N());const o={table:"tool_executeApex",insertValues:[{name:x.value.name,apexCode:w.value,shared:x.value.shared}],filter:{compareTo:"id",compareValue:(u=a==null?void 0:a.searchData)==null?void 0:u.id},selectValues:"id, name"},e=await ya(o);if((e==null?void 0:e.code)=="23505"&&(e!=null&&e.message)){b("Duplicate record exists, please choose different name.","Error"),h.value=!1;return}else e!=null&&e.id?(b("Record has been saved","Success"),W.push(`/tools/executeApex/${e==null?void 0:e.id}`)):(console.log("error --> "+JSON.stringify(e)),b("Record was not inserted, check dev console for errors","Error"));h.value=!1,C()};return la(()=>x.value.name,()=>{ee()}),ra(async()=>{await na(),f.value=await N(),await Re()}),(o,e)=>{var ce,ie,de,ue,me,fe,he,ye,xe,ge;const u=Ue,g=Le,Ie=Je,ne=Ze,B=We,E=Ke,je=Qe,Ne=ea,qe=aa;return i(),v(ua,null,[s("div",Da,[s("div",Sa,[l(u,{class:"mb-2",subText:(ce=a==null?void 0:a.searchData)==null?void 0:ce.name},{default:k(()=>e[6]||(e[6]=[A("Execute Anonymous Apex Code")])),_:1},8,["subText"]),l(g,null,{default:k(()=>{var m;return[A("Paste or type your apex and hit execute. "+_((m=a==null?void 0:a.searchData)!=null&&m.name?`Also you can use
                below url to share with your team.`:""),1)]}),_:1})]),s("div",null,[l(ma,{onDefaultOrgSelected:ke})])]),s("div",Ca,[s("div",null,[(ie=a==null?void 0:a.searchData)!=null&&ie.name&&((de=a==null?void 0:a.searchData)==null?void 0:de.name)!="NA"?(i(),v("div",Aa,[s("div",{class:"border rounded-lg px-3 py-1.5 flex items-center justify-between cursor-pointer flex-shrink-0 bg-slate-50 hover:bg-slate-100 dark:bg-gray-700/90 dark:border-gray-600 dark:text-gray-400 dark:hover:bg-gray-700/50 hover:border-slate-300 hover:shadow-md transition duration-300 ease-in-out",onClick:Te},[s("p",Ta,_(t(Y)),1),s("span",Ra,[l(t(Fe),{class:"h-4 w-4 text-gray-500 dark:text-gray-400 ml-4"})])])])):T("",!0)]),s("div",Va,[l(Ie,{class:"mr-2",searchTable:"tool_executeApex",isIcon:!1,routePath:"tools/executeApex",searchParams:t(Q)},null,8,["searchParams"]),l(ne,{onClick:we,class:c(["mr-2",[t(S)?"cursor-not-allowed opacity-80":"cursor-pointer"]]),disabled:t(S)},{default:k(()=>[t(S)?(i(),j(be,{key:0,cssStyle:"h-4 w-4 mr-2"},{default:k(()=>e[7]||(e[7]=[A("Executing code..")])),_:1})):(i(),v("div",Ba," Execute "))]),_:1},8,["class","disabled"]),t(w)?(i(),j(B,{key:0,icon:Ye,isSquare:!1,onClick:Ve,color:"green",class:"mr-2",title:"Save Record"})):T("",!0),(ue=a==null?void 0:a.searchData)!=null&&ue.id&&((me=a==null?void 0:a.searchData)==null?void 0:me.createdBy)==((fe=t(f))==null?void 0:fe.name)?(i(),j(B,{key:1,icon:Xe,isSquare:!1,onClick:Ee,color:"red",class:"mr-2",title:"Delete Record"})):T("",!0),l(B,{icon:Ge,isSquare:!1,color:"gray",class:"mr-2",title:"Reset Data",onClick:De}),P(l(B,{icon:ze,isSquare:!1,color:"blue",onClick:K,class:"!p-1.5 mr-4",title:"Toggle to Side by Side View"},null,512),[[$,t(n)]]),P(l(B,{icon:He,isSquare:!1,onClick:K,color:"blue",class:"!p-1.5 mr-4",title:"Toggle to Top vs Bottom View"},null,512),[[$,!t(n)]])])]),!t(L)&&t(D)?(i(),v("div",Ea,[e[9]||(e[9]=s("div",{class:"p-4 mb-4 text-sm text-red-800 rounded-lg bg-red-100 dark:bg-red-800/30 dark:text-red-300 border border-rose-100 dark:border-red-800/40"},[s("span",{class:"font-medium"},"Error Found!"),A(" Please check Error Message and Stack Trace below. ")],-1)),s("div",Pa,[s("table",$a,[e[8]||(e[8]=s("thead",{class:"text-gray-800 uppercase bg-gray-100 dark:bg-gray-700 dark:text-gray-400 text-center"},[s("tr",{class:"border-b dark:border-gray-600/80"},[s("th",{scope:"col",class:"px-4 py-2"},"Error Message"),s("th",{scope:"col",class:"px-2 py-3"},"Line Number"),s("th",{scope:"col",class:"px-4 py-2"},"Stack Trace")])],-1)),s("tbody",null,[s("tr",Oa,[s("td",Ia,_(t(D).exceptionMessage),1),s("td",ja,_(t(D).line),1),s("td",Na,_(t(D).exceptionStackTrace),1)])])])])])):T("",!0),s("div",{class:c({"flex flex-col lg:flex-row space-y-4 lg:space-y-0 lg:space-x-4 mt-8":!t(n)})},[s("div",{class:c(["w-full mr-3",{"lg:w-1/2":!t(n),"mt-2":t(n)}])},[s("div",{class:c(["",{"flex items-center justify-between":!t(n)}])},[l(E,{value:"Input Apex Code",class:c({"mb-2":!t(n),"mb-3":t(n)&&!((he=a==null?void 0:a.searchData)!=null&&he.createdBy)})},null,8,["class"]),(ye=a==null?void 0:a.searchData)!=null&&ye.createdBy?(i(),v("p",{key:0,class:c(["block font-medium text-sm text-gray-600 dark:text-gray-300 mb-2",{"ml-3 mr-2":!t(n),"mt-2":t(n)}])},"Created By : "+_((xe=a==null?void 0:a.searchData)==null?void 0:xe.createdBy)+" at "+_((ge=a==null?void 0:a.searchData)==null?void 0:ge.createdDate),3)):T("",!0)],2),s("div",qa,[l(t(J),{modelValue:t(w),"onUpdate:modelValue":e[0]||(e[0]=m=>z(w)?w.value=m:null),placeholder:"Paste your Apex Code here",style:ca({height:t(Z),borderRadius:"5px",overflow:"hidden",maxHeight:"600px",minHeight:"100px"}),autofocus:!0,"indent-with-tab":!0,"tab-size":2,extensions:q,onReady:U},null,8,["modelValue","style"])])],2),s("div",{class:c(["w-full mr-3",{"lg:w-1/2":!t(n),"mt-4":t(n)}])},[s("div",Ua,[l(E,{value:t(p)?t(F):t(X),class:c({"mb-2":!t(n),"mb-3":t(n)})},null,8,["value","class"]),s("div",La,[l(ve,{value:"Show Debug Only",isChecked:t(p),onChange:Se,class:"pb-2"},null,8,["isChecked"]),P(s("span",Ma,[s("button",{onClick:Ce,title:"Analyse debug log by Google Gemini AI",class:"mb-1"},[(i(),v("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",fill:"none",class:c({"animate-spin":t(M)})},e[10]||(e[10]=[ia('<path fill="url(#a)" d="M14 28c0-1.937-.373-3.757-1.12-5.46a13.898 13.898 0 0 0-2.975-4.445A13.897 13.897 0 0 0 5.46 15.12C3.757 14.373 1.937 14 0 14c1.937 0 3.757-.362 5.46-1.085 1.703-.747 3.185-1.75 4.445-3.01A13.897 13.897 0 0 0 12.88 5.46C13.627 3.757 14 1.937 14 0c0 1.937.362 3.757 1.085 5.46.747 1.703 1.75 3.185 3.01 4.445 1.26 1.26 2.742 2.263 4.445 3.01C24.243 13.638 26.063 14 28 14c-1.937 0-3.757.373-5.46 1.12a13.898 13.898 0 0 0-4.445 2.975c-1.26 1.26-2.263 2.742-3.01 4.445C14.362 24.243 14 26.063 14 28Z"></path><defs><radialGradient id="a" cx="0" cy="0" r="1" gradientTransform="rotate(18.683 -33.198 14.136) scale(29.8025 238.737)" gradientUnits="userSpaceOnUse"><stop offset=".067" stop-color="#9168C0"></stop><stop offset=".343" stop-color="#5684D1"></stop><stop offset=".672" stop-color="#1BA1E3"></stop></radialGradient></defs>',2)]),2))]),s("span",Fa,[s("span",{class:c(["absolute inline-flex h-full w-full rounded-full bg-green-600 opacity-80",{"animate-ping":t(y)!=""}])},null,2),e[11]||(e[11]=s("span",{class:"relative inline-flex rounded-full h-2 w-2 bg-green-500"},null,-1))])],512),[[$,t(y)!=""]])])]),P(s("div",Ga,[l(t(J),{modelValue:t(V),"onUpdate:modelValue":e[1]||(e[1]=m=>z(V)?V.value=m:null),placeholder:"No debug statement or fatal error lines present, hence no data.",style:{height:"auto",minHeight:"50px",maxHeight:"450px",borderRadius:"5px",overflow:"hidden"},autofocus:!0,"indent-with-tab":!0,"tab-size":2,extensions:q,onReady:U},null,8,["modelValue"])],512),[[$,t(p)]]),l(E,{value:t(p)?t(X):"",class:c({"mt-3 mb-3":t(p)})},null,8,["value","class"]),s("div",za,[l(t(J),{modelValue:t(y),"onUpdate:modelValue":e[2]||(e[2]=m=>z(y)?y.value=m:null),placeholder:"Your debug will appear here",style:{height:"600px",borderRadius:"5px",overflow:"hidden"},autofocus:!0,"indent-with-tab":!0,"tab-size":2,extensions:q,onReady:U},null,8,["modelValue"])])],2)],2),l(qe,{show:t(R),onClose:C,cssStyle:t(d)==="Delete"?"mt-72":""},{default:k(()=>[s("button",{type:"button",onClick:C,class:"absolute top-3 end-3 text-gray-400 bg-gray-100 hover:bg-gray-200 hover:text-gray-600 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:bg-gray-600 dark:text-white dark:hover:bg-gray-500 transition duration-200 ease-in-out"},[l(t(ka),{class:"w-6 h-6"}),e[12]||(e[12]=s("span",{class:"sr-only"},"Close modal",-1))]),s("div",Ha,[s("h2",{class:c(["text-lg font-medium text-gray-900 dark:text-gray-100",[t(d)=="Delete"?"text-center":""]])},_(t(O)),3),t(d)!="Delete"?(i(),v("p",Ja," You can save this data to cloud and retrive or share with your team. ")):(i(),v("p",{key:1,class:c(["mt-1 text-sm text-gray-600 dark:text-gray-400",[t(d)=="Delete"?"text-center":""]])}," This record will be permanently deleted. ",2)),s("form",{onSubmit:e[5]||(e[5]=da(m=>Ae(t(I)),["prevent"]))},[P(s("div",Wa,[l(E,{for:"name",value:"File Name",class:"mt-4"}),l(je,{modelValue:t(x).name,"onUpdate:modelValue":e[3]||(e[3]=m=>t(x).name=m),ref:"nameInput",type:"text",id:"name",class:"mt-1 block w-full py-2",required:t(d)!="Delete",placeholder:"Enter file name"},null,8,["modelValue","required"]),l(E,{for:"shared",value:"is Public?",class:"mt-4"}),t(d)!="Delete"?(i(),v("p",Ya," Allow others to access, recommended if you want to share data with your team. ")):T("",!0),l(ve,{isChecked:t(x).shared,onChange:e[4]||(e[4]=m=>t(x).shared=!t(x).shared),class:"mt-2"},null,8,["isChecked"])],512),[[$,t(d)!="Delete"]]),s("div",{class:c(t(d)=="Delete"?"mt-6 text-center":"mt-6 flex justify-end")},[l(Ne,{onClick:C},{default:k(()=>e[13]||(e[13]=[A(" Cancel ")])),_:1}),l(ne,{class:c(["ml-3",[t(d)=="Delete"?"bg-red-600 hover:bg-red-500 active:bg-red-700 focus:ring-red-500":"",t(h)?"cursor-not-allowed opacity-80":"cursor-pointer"]]),disabled:t(h)},{default:k(()=>[t(h)?(i(),j(be,{key:0,cssStyle:"h-4 w-4 mr-2"},{default:k(()=>e[14]||(e[14]=[A("Saving.. ")])),_:1})):(i(),v("div",Xa,_(t(d)),1))]),_:1},8,["class","disabled"])],2)],32)])]),_:1},8,["show","cssStyle"])],64)}}});export{yt as _};
